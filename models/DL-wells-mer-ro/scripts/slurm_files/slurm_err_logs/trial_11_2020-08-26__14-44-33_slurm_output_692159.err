cpu-bind=MASK - node107, task  0  0 [21383]: mask 0x101 set
cpu-bind=MASK - node178, task 20  0 [18208]: mask 0x400 set
cpu-bind=MASK - node177, task 19  1 [15391]: mask 0x800 set
cpu-bind=MASK - node175, task 16  0 [18971]: mask 0x400 set
cpu-bind=MASK - node174, task 15  1 [5872]: mask 0x800 set
cpu-bind=MASK - node171, task  8  0 [7181]: mask 0x40 set
cpu-bind=MASK - node136, task  6  0 [27301]: mask 0x400 set
cpu-bind=MASK - node135, task  4  0 [16761]: mask 0x400 set
cpu-bind=MASK - node107, task  1  1 [21414]: mask 0x100 set
cpu-bind=MASK - node178, task 21  1 [18209]: mask 0x800 set
cpu-bind=MASK - node177, task 18  0 [15390]: mask 0x400 set
cpu-bind=MASK - node175, task 17  1 [18972]: mask 0x800 set
cpu-bind=MASK - node174, task 14  0 [5871]: mask 0x400 set
cpu-bind=MASK - node171, task  9  1 [7182]: mask 0x80 set
cpu-bind=MASK - node136, task  7  1 [27302]: mask 0x800 set
cpu-bind=MASK - node135, task  5  1 [16762]: mask 0x800 set
cpu-bind=MASK - node107, task  0  0 [21413]: mask 0x1 set
cpu-bind=MASK - node134, task  2  0 [2690]: mask 0x400 set
cpu-bind=MASK - node134, task  3  1 [2691]: mask 0x800 set
cpu-bind=MASK - node173, task 13  1 [23728]: mask 0x800 set
cpu-bind=MASK - node172, task 10  0 [10760]: mask 0x4000 set
cpu-bind=MASK - node173, task 12  0 [23727]: mask 0x400 set
cpu-bind=MASK - node172, task 11  1 [10761]: mask 0x8000 set
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 5, MEMBER: 6/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 7, MEMBER: 8/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 21, MEMBER: 22/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 3, MEMBER: 4/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 17, MEMBER: 18/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 19, MEMBER: 20/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 9, MEMBER: 10/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 15, MEMBER: 16/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 13, MEMBER: 14/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 6, MEMBER: 7/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 11, MEMBER: 12/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 10, MEMBER: 11/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 8, MEMBER: 9/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 20, MEMBER: 21/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 4, MEMBER: 5/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 18, MEMBER: 19/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 16, MEMBER: 17/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 2, MEMBER: 3/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 14, MEMBER: 15/22
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
CUDA_VISIBLE_DEVICES: [0,1]
initializing ddp: GLOBAL_RANK: 12, MEMBER: 13/22
----------------------------------------------------------------------------------------------------
distributed_backend=ddp
All DDP processes registered. Starting ddp with 22 processes
----------------------------------------------------------------------------------------------------
/usr/home/rlopez/.local/lib/python3.8/site-packages/pytorch_lightning/utilities/distributed.py:37: UserWarning: Could not log computational graph since the `model.example_input_array` attribute is not set or `input_array` was not given
  warnings.warn(*args, **kwargs)
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.
Set SLURM handle signals.

  | Name    | Type      | Params
--------------------------------------
0 | resnet  | ResNet    | 11 M  
1 | relu    | ReLU      | 0     
2 | drop    | Dropout   | 0     
3 | embed   | Embedding | 1 M   
4 | lstm    | LSTM      | 603 K 
5 | linear  | Linear    | 2 M   
6 | dropout | Dropout   | 0     
Set SLURM handle signals.
Set SLURM handle signals.
Traceback (most recent call last):
  File "/cluster/apps/python/3.8.2/lib/python3.8/multiprocessing/queues.py", line 245, in _feed
    send_bytes(obj)
  File "/cluster/apps/python/3.8.2/lib/python3.8/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/cluster/apps/python/3.8.2/lib/python3.8/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/cluster/apps/python/3.8.2/lib/python3.8/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..
Saving latest checkpoint..


Profiler Report

Action              	|  Mean duration (s)	|  Total time (s) 
-----------------------------------------------------------------
on_train_start      	|  0.016032       	|  0.016032       
on_epoch_start      	|  0.00032336     	|  0.016168       
on_train_epoch_start	|  1.1945e-05     	|  0.00059725     
get_train_batch     	|  0.0048261      	|  182.91         
on_batch_start      	|  6.205e-05      	|  2.3486         
on_train_batch_start	|  4.121e-05      	|  1.5598         
model_forward       	|  0.028522       	|  1079.6         
model_backward      	|  0.043903       	|  1661.7         
on_after_backward   	|  2.6419e-06     	|  0.099996       
optimizer_step      	|  0.012859       	|  486.71         
on_batch_end        	|  3.1045e-05     	|  1.1751         
on_train_batch_end  	|  0.0010061      	|  38.08          
on_epoch_end        	|  2.5886e-05     	|  0.0012943      
on_train_epoch_end  	|  8.5455e-06     	|  0.00042728     
on_train_end        	|  0.00055715     	|  0.00055715     

